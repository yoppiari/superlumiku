# ==============================================
# AI SERVICES CONFIGURATION
# Avatar & Pose Generator - Phase 1-4 Implementation
# ==============================================

# ============================================
# PHASE 1: CONTROLNET POSE GENERATION (CORE)
# ============================================

# Hugging Face API Key (Required)
# Get your key at: https://huggingface.co/settings/tokens
# Free tier: 30k requests/month
HUGGINGFACE_API_KEY=hf_xxxxxxxxxxxxxxxxxxxxx

# ControlNet Models
CONTROLNET_MODEL_SD=lllyasviel/control_v11p_sd15_openpose
CONTROLNET_MODEL_HD=thibaud/controlnet-openpose-sdxl-1.0

# ============================================
# PHASE 2: TEXT-TO-AVATAR GENERATION
# ============================================

# SDXL Model for Avatar Generation
SDXL_MODEL=stabilityai/stable-diffusion-xl-base-1.0

# Alternative: FLUX.1 (faster, higher quality)
# FLUX_MODEL=black-forest-labs/FLUX.1-schnell

# ============================================
# PHASE 3: FASHION ENHANCEMENT
# ============================================

# Inpainting Model
INPAINTING_MODEL=runwayml/stable-diffusion-inpainting

# Segmind API Key (Optional - for better inpainting)
# Get your key at: https://segmind.com/
# Free tier: $5 credits
# SEGMIND_API_KEY=xxxxx

# ============================================
# PHASE 4: BACKGROUND & THEMES
# ============================================

# Background Generation Model
BACKGROUND_MODEL=stabilityai/stable-diffusion-xl-base-1.0

# ============================================
# MODELSLAB FALLBACK (Optional)
# ============================================

# ModelsLab API Key (if you have it)
# MODELSLAB_API_KEY=xxxxx

# ============================================
# STORAGE CONFIGURATION
# ============================================

# Avatar storage path
AVATAR_STORAGE_PATH=./uploads/avatars

# Pose generation output path
POSE_OUTPUT_PATH=./uploads/pose-generator

# Maximum file sizes
MAX_AVATAR_SIZE_MB=10
MAX_PRODUCT_SIZE_MB=20

# ============================================
# GENERATION LIMITS
# ============================================

# Maximum poses per generation batch
MAX_POSES_PER_GENERATION=100

# Concurrent generation limit
CONCURRENT_GENERATION_LIMIT=3

# ============================================
# API TIMEOUTS
# ============================================

# HuggingFace API timeout (milliseconds)
HF_API_TIMEOUT=120000

# Generation timeout per pose (seconds)
POSE_GENERATION_TIMEOUT=180

# ============================================
# FEATURE FLAGS
# ============================================

# Enable/disable specific features
ENABLE_CONTROLNET=true
ENABLE_TEXT_TO_AVATAR=true
ENABLE_FASHION_ENHANCEMENT=true
ENABLE_BACKGROUND_REPLACEMENT=true
ENABLE_PROFESSION_THEMES=true

# ============================================
# NOTES & INSTRUCTIONS
# ============================================

# 1. REQUIRED: HUGGINGFACE_API_KEY
#    - This is the ONLY required API key to get started
#    - Get it free at: https://huggingface.co/settings/tokens
#    - Select "Read" access when creating the token
#
# 2. Optional: SEGMIND_API_KEY
#    - Only needed if you want better fashion enhancement
#    - Free $5 credits at signup: https://segmind.com/
#
# 3. Optional: MODELSLAB_API_KEY
#    - Use as fallback if HuggingFace is down
#    - You may already have this key configured
#
# 4. Storage Paths:
#    - Make sure the upload directories exist
#    - Backend will create them automatically if missing
#
# 5. Timeouts:
#    - HF models may take longer on first load (cold start)
#    - Increase timeouts if you experience failures
#
# 6. Rate Limits:
#    - HuggingFace Free: 30k requests/month
#    - Segmind Free: $5 credits
#    - Adjust CONCURRENT_GENERATION_LIMIT to avoid rate limits

# ==============================================
# SETUP INSTRUCTIONS
# ==============================================

# Step 1: Copy this file to .env in backend directory
#   cp .env.ai.example backend/.env
#
# Step 2: Get Hugging Face API key
#   Visit: https://huggingface.co/settings/tokens
#   Click "New token"
#   Select "Read" access
#   Copy the token starting with "hf_"
#
# Step 3: Replace HUGGINGFACE_API_KEY value
#   HUGGINGFACE_API_KEY=hf_your_actual_token_here
#
# Step 4: (Optional) Get Segmind API key for better results
#   Visit: https://segmind.com/
#   Sign up for free $5 credits
#   Go to API Keys section
#   Copy your API key
#
# Step 5: Test the setup
#   cd backend && bun dev
#   Check logs for any errors
#
# Step 6: Verify AI services are working
#   - Try uploading an avatar
#   - Try generating a pose
#   - Check console logs for success messages

# ==============================================
# TROUBLESHOOTING
# ==============================================

# Problem: "HUGGINGFACE_API_KEY is required" error
# Solution: Make sure you've set the API key correctly
#
# Problem: Slow generation / timeouts
# Solution: Models may be cold-starting. Wait 30-60 seconds and retry.
#          Or increase HF_API_TIMEOUT value.
#
# Problem: "Rate limit exceeded"
# Solution: You've exceeded your monthly quota.
#          Wait for reset or upgrade to HF Pro ($9/month)
#
# Problem: Poor quality results
# Solution: Try HD quality mode (costs more credits)
#          Or adjust prompts in the services
#
# Problem: Canvas/Sharp errors
# Solution: Make sure dependencies are installed:
#          cd backend && bun add canvas sharp

# ==============================================
# COST ESTIMATION
# ==============================================

# HuggingFace Free Tier (30k requests/month):
# - ControlNet pose generation: ~1 request per pose
# - Text-to-avatar: ~1 request per avatar
# - Inpainting: ~1 request per enhancement
# - Background: ~1 request per replacement
#
# Example monthly usage:
# - 100 avatars × 1 = 100 requests
# - 100 poses × 1 = 100 requests
# - 50 fashion enhancements × 1 = 50 requests
# - 50 background replacements × 1 = 50 requests
# Total: 300 requests/month (well within free tier)
#
# To process 1000 poses/month:
# - Need HuggingFace Pro: $9/month
# - Or use multiple free accounts (not recommended)
# - Or self-host models (requires GPU server)

# ==============================================
# PRODUCTION RECOMMENDATIONS
# ==============================================

# 1. Use environment-specific .env files:
#    - .env.development (local development)
#    - .env.production (deployed on dev.lumiku.com)
#
# 2. Never commit API keys to git
#    - Add .env to .gitignore
#    - Use secrets management in production (Coolify secrets)
#
# 3. Monitor API usage:
#    - Check HuggingFace dashboard regularly
#    - Set up alerts for quota limits
#
# 4. Implement caching:
#    - Cache generated poses to avoid regeneration
#    - Store successful results for reuse
#
# 5. Consider self-hosting for scale:
#    - Once you exceed 1000 generations/month
#    - Set up GPU server with local models
#    - Reduces API costs significantly
